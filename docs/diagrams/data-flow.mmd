flowchart TD
    subgraph Sources["ğŸŒ Data Sources"]
        A1[ğŸ“Š ApartmentList<br/>Rent Estimates]
        A2[ğŸ  Zillow ZORI<br/>Metro Rent Index]
        A3[ğŸ›ï¸ FRED CPI<br/>Economic Indicators]
    end

    subgraph Bronze["ğŸ¥‰ Bronze Layer (RAW)"]
        B1[APTLIST_LONG<br/>Raw CSV Data]
        B2[ZORI_METRO_LONG<br/>Raw CSV Data]
        B3[FRED_CPI_LONG<br/>Raw CSV Data]
    end

    subgraph Silver["ğŸ¥ˆ Silver Layer (ANALYTICS)"]
        C1[DIM_LOCATION<br/>SCD Type 2]
        C2[DIM_TIME<br/>Calendar]
        C3[DIM_ECONOMIC_SERIES<br/>SCD Type 2]
        C4[DIM_DATA_SOURCE<br/>Static]
        D1[FACT_RENT_ZORI<br/>Rent Facts]
        D2[FACT_RENT_APTLIST<br/>Rent Facts]
        D3[FACT_ECONOMIC_INDICATOR<br/>CPI Facts]
    end

    subgraph Gold["ğŸ¥‡ Gold Layer (BUSINESS VIEWS)"]
        E1[VW_RENT_TRENDS<br/>ğŸ“ˆ Growth Analysis]
        E2[VW_MARKET_RANKINGS<br/>ğŸ† Heat Scores]
        E3[VW_ECONOMIC_CORRELATION<br/>ğŸ’° Rent vs CPI]
        E4[VW_REGIONAL_SUMMARY<br/>ğŸ—ºï¸ State Aggregates]
        E5[VW_DATA_LINEAGE<br/>ğŸ” Quality Monitor]
    end

    subgraph ETL["âš™ï¸ ETL Processes"]
        F1[SP_LOAD_DIM_LOCATION_SCD2<br/>ğŸ“ Geographic Updates]
        F2[SP_LOAD_FACT_RENT_ZORI<br/>ğŸ  Zillow Processing]
        F3[SP_LOAD_FACT_RENT_APTLIST<br/>ğŸ¢ ApartmentList Processing]
        F4[SP_FULL_ETL_PROCESS<br/>ğŸ”„ Master Orchestration]
    end

    %% Data Flow
    A1 --> B1
    A2 --> B2
    A3 --> B3

    B1 --> F1
    B2 --> F1
    B1 --> F3
    B2 --> F2
    B3 --> ETL

    F1 --> C1
    ETL --> C2
    ETL --> C3
    ETL --> C4
    F2 --> D1
    F3 --> D2
    ETL --> D3

    C1 --> E1
    C2 --> E1
    D1 --> E1
    D2 --> E1

    C1 --> E2
    D1 --> E2
    D2 --> E2

    D1 --> E3
    D2 --> E3
    D3 --> E3

    C1 --> E4
    D1 --> E4
    D2 --> E4

    C1 --> E5
    C3 --> E5
    C4 --> E5

    %% Styling
    classDef sourceStyle fill:#e1f5fe,stroke:#01579b,stroke-width:2px
    classDef bronzeStyle fill:#fff3e0,stroke:#e65100,stroke-width:2px
    classDef silverStyle fill:#f3e5f5,stroke:#4a148c,stroke-width:2px
    classDef goldStyle fill:#fff8e1,stroke:#ff6f00,stroke-width:2px
    classDef etlStyle fill:#e8f5e8,stroke:#1b5e20,stroke-width:2px

    class A1,A2,A3 sourceStyle
    class B1,B2,B3 bronzeStyle
    class C1,C2,C3,C4,D1,D2,D3 silverStyle
    class E1,E2,E3,E4,E5 goldStyle
    class F1,F2,F3,F4 etlStyle