---
title: Tampa Rent Signals - Dagster Orchestration Architecture
---
graph TB
    %% Data Sources
    subgraph "🌐 Data Sources"
        A1[📊 ApartmentList<br/>Rent Estimates]
        A2[🏠 Zillow ZORI<br/>Metro Rent Index]
        A3[🏛️ FRED CPI<br/>Economic Indicators]
    end

    %% Raw Layer
    subgraph "🥉 Bronze Layer (RAW)"
        B1[APTLIST_LONG<br/>Raw CSV Data]
        B2[ZORI_METRO_LONG<br/>Raw CSV Data]
        B3[FRED_CPI_LONG<br/>Raw CSV Data]
    end

    %% Dagster Staging Assets
    subgraph "🥈 Silver Layer - Dagster Staging Assets"
        direction TB
        C1[stg_aptlist<br/>🔍 Quality Scoring<br/>📊 Business Keys]
        C2[stg_zori<br/>🏙️ Metro Classification<br/>📈 Anomaly Detection]
        C3[stg_fred<br/>📋 Series Validation<br/>⭐ Reliability Scoring]
        
        %% Asset Checks for Staging
        C1 -.-> C1_CHECK[stg_aptlist_quality_check<br/>🛡️ GE Validation<br/>⏰ Freshness Check]
        C2 -.-> C2_CHECK[stg_zori_quality_check<br/>🛡️ GE Validation<br/>⏰ Freshness Check]
        C3 -.-> C3_CHECK[stg_fred_quality_check<br/>🛡️ GE Validation<br/>⏰ Freshness Check]
    end

    %% Snapshots
    subgraph "📸 SCD Type 2 Snapshots"
        S1[snap_location<br/>🔄 Hash-based Change Detection<br/>📅 Effective Dating]
        S2[snap_economic_series<br/>🔄 Metadata Tracking<br/>📅 Version History]
    end

    %% Core Assets
    subgraph "🥈 Silver Layer - Dagster Core Assets"
        direction TB
        D1[dim_time<br/>📅 Calendar Dimension]
        D2[dim_location<br/>🗺️ Location SCD Type 2]
        D3[dim_economic_series<br/>📊 Series SCD Type 2]
        D4[dim_data_source<br/>📋 Static Reference]
        
        F1[fact_rent_zori<br/>🏠 Rent Facts<br/>📈 YoY/MoM Calculations<br/>🎯 Investment Scoring]
        F2[fact_rent_aptlist<br/>🏢 Rent Facts<br/>👥 Population Analytics<br/>🏷️ Market Classification]
        F3[fact_economic_indicator<br/>💰 Economic Facts<br/>📊 Trend Analysis<br/>🔄 Policy Tracking]
        
        %% Asset Checks for Core
        F1 -.-> F1_CHECK[fact_rent_zori_quality_check<br/>🛡️ Business Rules<br/>📊 Growth Bounds]
        F2 -.-> F2_CHECK[fact_rent_aptlist_quality_check<br/>👥 Population Validation<br/>🏷️ Classification Check]
    end

    %% Mart Assets
    subgraph "🥇 Gold Layer - Dagster Mart Assets"
        direction TB
        M1[mart_rent_trends<br/>🔀 Cross-source Analysis<br/>🌡️ Market Temperature<br/>💡 Investment Scoring]
        M2[mart_market_rankings<br/>🏆 Competitiveness<br/>🔥 Heat Scores<br/>💼 Recommendations]
        M3[mart_economic_correlation<br/>💰 Rent vs Inflation<br/>📊 Policy Analysis<br/>🔗 Leading Indicators]
        M4[mart_regional_summary<br/>🗺️ State Aggregates<br/>📈 Growth Patterns<br/>🏛️ Policy Climate]
        M5[mart_data_lineage<br/>🔍 Quality Monitoring<br/>⏰ Freshness Tracking<br/>📊 Operational Dashboard]
        
        %% Asset Checks for Marts
        M1 -.-> M1_CHECK[mart_rent_trends_quality_check<br/>🛡️ Completeness<br/>📊 Business Metrics]
        M2 -.-> M2_CHECK[market_heat_score_check<br/>🔥 Score Range (0-100)<br/>📊 Distribution Check]
        M1 -.-> M1_FRESH[mart_rent_trends_freshness_check<br/>⏰ <72 hours]
    end

    %% Dagster Jobs
    subgraph "⚙️ Dagster Pipeline Jobs"
        J1[staging_pipeline<br/>🚀 Daily 6AM EST<br/>🔍 Quality Gates]
        J2[core_pipeline<br/>🏗️ Star Schema Build<br/>📸 SCD Type 2]
        J3[marts_pipeline<br/>📊 Business Analytics<br/>💼 Executive Reports]
        J4[full_refresh_pipeline<br/>🔄 Weekly Sunday 2AM<br/>🧪 Complete Validation]
    end

    %% Sensors and Schedules
    subgraph "📡 Automation & Monitoring"
        SENSOR[data_freshness_sensor<br/>👁️ Monitors Raw Tables<br/>⚡ Auto-trigger Staging<br/>⏱️ 1hr Cooldown]
        SCHEDULE1[daily_refresh_schedule<br/>⏰ 6AM EST Daily<br/>🎯 Staging Pipeline]
        SCHEDULE2[weekly_validation_schedule<br/>📅 Sunday 2AM EST<br/>🔄 Full Refresh]
    end

    %% Data Flow
    A1 --> B1
    A2 --> B2
    A3 --> B3

    B1 --> C1
    B2 --> C2
    B3 --> C3

    C1 --> S1
    C2 --> S1
    C1 --> F2
    C2 --> F1
    C3 --> F3

    S1 --> D2
    S2 --> D3
    C3 --> S2

    D1 --> F1
    D1 --> F2
    D1 --> F3
    D2 --> F1
    D2 --> F2
    D3 --> F3
    D4 --> F1
    D4 --> F2
    D4 --> F3

    F1 --> M1
    F1 --> M2
    F1 --> M3
    F2 --> M1
    F2 --> M2
    F2 --> M3
    F3 --> M3
    D2 --> M4
    D3 --> M5
    D4 --> M5

    %% Job Execution Flow
    J1 --> J2
    J2 --> J3
    
    %% Sensor Triggers
    SENSOR -.-> J1
    SCHEDULE1 -.-> J1
    SCHEDULE2 -.-> J4

    %% Asset Check Dependencies (blocking)
    C1_CHECK -.->|blocks if failed| F2
    C2_CHECK -.->|blocks if failed| F1
    C3_CHECK -.->|blocks if failed| F3

    %% Styling
    classDef sourceStyle fill:#e1f5fe,stroke:#01579b,stroke-width:2px
    classDef bronzeStyle fill:#fff3e0,stroke:#e65100,stroke-width:2px
    classDef stagingStyle fill:#f3e5f5,stroke:#4a148c,stroke-width:2px
    classDef coreStyle fill:#e8f5e8,stroke:#1b5e20,stroke-width:2px
    classDef martStyle fill:#fff8e1,stroke:#ff6f00,stroke-width:2px
    classDef jobStyle fill:#fce4ec,stroke:#880e4f,stroke-width:2px
    classDef automationStyle fill:#f1f8e9,stroke:#33691e,stroke-width:2px
    classDef checkStyle fill:#fff3e0,stroke:#f57c00,stroke-width:1px,stroke-dasharray: 5 5

    class A1,A2,A3 sourceStyle
    class B1,B2,B3 bronzeStyle
    class C1,C2,C3 stagingStyle
    class S1,S2,D1,D2,D3,D4,F1,F2,F3 coreStyle
    class M1,M2,M3,M4,M5 martStyle
    class J1,J2,J3,J4 jobStyle
    class SENSOR,SCHEDULE1,SCHEDULE2 automationStyle
    class C1_CHECK,C2_CHECK,C3_CHECK,F1_CHECK,F2_CHECK,M1_CHECK,M2_CHECK,M1_FRESH checkStyle