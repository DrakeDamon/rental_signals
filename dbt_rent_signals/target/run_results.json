{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.13", "generated_at": "2025-10-26T12:40:12.721501Z", "invocation_id": "ef0da71d-5790-47ee-a26f-daccb95733a4", "invocation_started_at": "2025-10-26T12:39:59.858960Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T12:40:08.815886Z", "completed_at": "2025-10-26T12:40:08.823166Z"}, {"name": "execute", "started_at": "2025-10-26T12:40:08.823506Z", "completed_at": "2025-10-26T12:40:11.322024Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.506856918334961, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bff7d8-0000-414c-0010-304f000283d6"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.rent_signals.dim_location", "compiled": true, "compiled_code": "\n\n-- Combine location data from all sources\nwith all_locations as (\n    -- ApartmentList locations\n    select\n        location_business_key,\n        coalesce(location_fips_code, 'UNKNOWN') as location_fips_code,\n        cast(regionid as varchar) as regionid,  -- Cast here to handle 'overall'\n        location_name,\n        location_type,\n        state_name,\n        county,\n        metro,\n        null as size_rank,\n        population,\n        'ApartmentList' as source_system\n    from RENTS.DBT_DEV_staging.stg_aptlist\n    where location_business_key is not null\n    \n    union all\n    \n    -- Zillow ZORI locations  \n    select\n        location_business_key,\n        null as location_fips_code,\n        cast(regionid as varchar) as regionid,  -- Cast here too\n        location_name,\n        location_type,\n        state_name,\n        null as county,\n        location_name as metro,\n        size_rank,\n        null as population,\n        'Zillow ZORI' as source_system\n    from RENTS.DBT_DEV_staging.stg_zori\n    where location_business_key is not null\n),\n\n-- Deduplicate and merge\nmerged_locations as (\n    select distinct\n        location_business_key,\n        max(location_fips_code) as location_fips_code,\n        max(regionid) as regionid,  -- Already cast in CTEs above\n        max(location_name) as location_name,\n        max(location_type) as location_type,\n        max(state_name) as state_name,\n        max(county) as county_name,\n        max(metro) as metro_name,\n        max(size_rank) as size_rank,\n        max(population) as population,\n        listagg(distinct source_system, ', ') within group (order by source_system) as source_systems\n    from all_locations\n    group by location_business_key\n)\n\nselect\n    -- Surrogate key\n    md5(cast(coalesce(cast(location_business_key as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as location_key,\n    \n    -- Business keys\n    location_fips_code,\n    regionid,\n    location_business_key,\n    \n    -- Attributes\n    location_name,\n    location_type,\n    state_name,\n    county_name,\n    metro_name,\n    size_rank,\n    population,\n    \n    -- Derived attributes\n    case \n        when upper(state_name) like '%FLORIDA%' or upper(state_name) = 'FL' then 'FL'\n        when upper(state_name) like '%CALIFORNIA%' or upper(state_name) = 'CA' then 'CA'\n        when upper(state_name) like '%TEXAS%' or upper(state_name) = 'TX' then 'TX'\n        when upper(state_name) like '%NEW YORK%' or upper(state_name) = 'NY' then 'NY'\n        else left(upper(coalesce(state_name, 'UNKNOWN')), 2)\n    end as state_code,\n    \n    case \n        when population >= 5000000 then 'Major Metro (5M+)'\n        when population >= 1000000 then 'Large Metro (1M-5M)'\n        when population >= 250000 then 'Medium Metro (250K-1M)'\n        when population < 250000 then 'Small Metro (<250K)'\n        else 'Unknown Size'\n    end as market_size_category,\n    \n    case\n        when size_rank <= 10 then 'Top 10 Markets'\n        when size_rank <= 50 then 'Top 50 Markets'\n        when size_rank <= 100 then 'Top 100 Markets'\n        when size_rank <= 200 then 'Large Markets'\n        else 'Small Markets'\n    end as size_rank_category,\n    \n    -- Geographic coordinates for map visualization\n    case \n        when location_name ilike '%Tampa%St%Petersburg%' then 27.9506\n        when location_name ilike '%Miami%' then 25.7617\n        when location_name ilike '%Orlando%' then 28.5383\n        when location_name ilike '%Jacksonville%' then 30.3322\n        when location_name ilike '%New York%' then 40.7128\n        when location_name ilike '%Los Angeles%' then 34.0522\n        when location_name ilike '%Chicago%' then 41.8781\n        when location_name ilike '%Houston%' then 29.7604\n        when location_name ilike '%Phoenix%' then 33.4484\n        when location_name ilike '%Philadelphia%' then 39.9526\n        when location_name ilike '%San Antonio%' then 29.4241\n        when location_name ilike '%San Diego%' then 32.7157\n        when location_name ilike '%Dallas%' then 32.7767\n        when location_name ilike '%San Jose%' then 37.3382\n        when location_name ilike '%Austin%' then 30.2672\n        when location_name ilike '%Fort Worth%' then 32.7555\n        when location_name ilike '%Columbus%' then 39.9612\n        when location_name ilike '%Charlotte%' then 35.2271\n        when location_name ilike '%San Francisco%' then 37.7749\n        when location_name ilike '%Indianapolis%' then 39.7684\n        when location_name ilike '%Seattle%' then 47.6062\n        when location_name ilike '%Denver%' then 39.7392\n        when location_name ilike '%Boston%' then 42.3601\n        when location_name ilike '%Nashville%' then 36.1627\n        when location_name ilike '%Detroit%' then 42.3314\n        when location_name ilike '%Portland%' then 45.5152\n        when location_name ilike '%Las Vegas%' then 36.1699\n        when location_name ilike '%Atlanta%' then 33.7490\n        when location_name ilike '%Raleigh%' then 35.7796\n        when location_name ilike '%Minneapolis%' then 44.9778\n        else null\n    end as latitude,\n    \n    case \n        when location_name ilike '%Tampa%St%Petersburg%' then -82.4572\n        when location_name ilike '%Miami%' then -80.1918\n        when location_name ilike '%Orlando%' then -81.3792\n        when location_name ilike '%Jacksonville%' then -81.6557\n        when location_name ilike '%New York%' then -74.0060\n        when location_name ilike '%Los Angeles%' then -118.2437\n        when location_name ilike '%Chicago%' then -87.6298\n        when location_name ilike '%Houston%' then -95.3698\n        when location_name ilike '%Phoenix%' then -112.0740\n        when location_name ilike '%Philadelphia%' then -75.1652\n        when location_name ilike '%San Antonio%' then -98.4936\n        when location_name ilike '%San Diego%' then -117.1611\n        when location_name ilike '%Dallas%' then -96.7970\n        when location_name ilike '%San Jose%' then -121.8863\n        when location_name ilike '%Austin%' then -97.7431\n        when location_name ilike '%Fort Worth%' then -97.3308\n        when location_name ilike '%Columbus%' then -82.9988\n        when location_name ilike '%Charlotte%' then -80.8431\n        when location_name ilike '%San Francisco%' then -122.4194\n        when location_name ilike '%Indianapolis%' then -86.1581\n        when location_name ilike '%Seattle%' then -122.3321\n        when location_name ilike '%Denver%' then -104.9903\n        when location_name ilike '%Boston%' then -71.0589\n        when location_name ilike '%Nashville%' then -86.7816\n        when location_name ilike '%Detroit%' then -83.0458\n        when location_name ilike '%Portland%' then -122.6784\n        when location_name ilike '%Las Vegas%' then -115.1398\n        when location_name ilike '%Atlanta%' then -84.3880\n        when location_name ilike '%Raleigh%' then -78.6382\n        when location_name ilike '%Minneapolis%' then -93.2650\n        else null\n    end as longitude,\n    \n    -- URL-friendly metro slug for routing\n    lower(\n        replace(\n            replace(\n                replace(\n                    replace(location_name, ', ', '-'),\n                    ' ', '-'\n                ),\n                ',', ''\n            ),\n            '--', '-'\n        )\n    ) as metro_slug,\n    \n    -- Source tracking\n    source_systems,\n    \n    -- Metadata (simplified - no SCD2)\n    true as is_current,\n    current_timestamp() as created_at,\n    '2025-10-26 12:39:59.859459+00:00' as dbt_run_id\n    \nfrom merged_locations", "relation_name": "RENTS.DBT_DEV_core.dim_location", "batch_results": null}], "elapsed_time": 8.715635061264038, "args": {"validate_macro_args": false, "require_batched_execution_for_custom_microbatch_strategy": false, "select": ["dim_location"], "state_modified_compare_more_unrendered_values": false, "indirect_selection": "eager", "use_colors": true, "which": "run", "use_fast_test_edges": false, "partial_parse_file_diff": true, "log_path": "/Users/daviddamon/Desktop/tampa rental signals/tampa-rent-signals/dbt_rent_signals/logs", "partial_parse": true, "project_dir": "/Users/daviddamon/Desktop/tampa rental signals/tampa-rent-signals/dbt_rent_signals", "favor_state": false, "log_format": "default", "require_all_warnings_handled_by_warn_error": false, "invocation_command": "dbt run --models dim_location", "require_nested_cumulative_type_params": false, "strict_mode": false, "warn_error_options": {"error": [], "warn": [], "silence": []}, "show_all_deprecations": false, "log_level": "info", "version_check": true, "exclude": [], "require_explicit_package_overrides_for_builtin_materializations": true, "vars": {}, "profiles_dir": "/Users/daviddamon/Desktop/tampa rental signals/tampa-rent-signals/dbt_rent_signals", "quiet": false, "log_file_max_bytes": 10485760, "upload_to_artifacts_ingest_api": false, "static_parser": true, "require_yaml_configuration_for_mf_time_spines": false, "use_colors_file": true, "empty": false, "skip_nodes_if_on_run_start_fails": false, "require_generic_test_arguments_property": true, "print": true, "cache_selected_only": false, "printer_width": 80, "log_level_file": "debug", "defer": false, "log_format_file": "debug", "populate_cache": true, "state_modified_compare_vars": false, "write_json": true, "macro_debugging": false, "send_anonymous_usage_stats": true, "require_resource_names_without_spaces": true, "source_freshness_run_project_hooks": true, "introspect": true, "show_resource_report": false}}